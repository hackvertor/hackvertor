[
  {
    "name": "jwt",
    "contexts": ["request"],
    "type": "Context Menu",
    "analysis": "import re\n\n_jwt = re.compile(r'eyJ[A-Za-z0-9_-]*\\.eyJ[A-Za-z0-9_-]*\\.[A-Za-z0-9_-]*')\n\ndef find_positions(text):\n    positions = [\"{},{}\".format(m.start(), m.end()) for m in _jwt.finditer(text)]\n    return \";\".join(positions)\n\noutput = find_positions(input)",
    "modification": "def wrap(input):\n    parts = input.split(\".\")\n    if len(parts) != 3:\n        return input\n    header, payload, _ = parts\n    decoded_header = convert(\"<@d_base64url>\" + header + \"<\/@d_base64url>\")\n    decoded_payload = convert(\"<@d_base64url>\" + payload + \"<\/@d_base64url>\")\n    return \"<@base64url>{}<\/@base64url>.<@base64url>{}<\/@base64url>.{}\".format(decoded_header,decoded_payload,_)\n\noutput = wrap(input)",
    "enabled": true,
    "tool": "Repeater"
  },
  {
    "name": "Set a variable to response",
    "contexts": ["response"],
    "type": "HTTP",
    "analysis": "output = \"0,\" + str(len(input))",
    "modification": "def wrap(input):\n    return \"<@set_response(true)>{}<\/@set_response>\".format(input)\noutput = wrap(input)",
    "enabled": true,
    "tool": "Repeater"
  },
  {
    "name": "Calling AI cracking a hash",
    "contexts": ["request"],
    "type": "Context Menu",
    "analysis": "import re\n\nhashes = re.compile(r'[a-f0-9]{32}')\n\ndef find_positions(text):\n    positions = [\"{},{}\".format(m.start(), m.end()) for m in hashes.finditer(text)]\n    return \";\".join(positions)\n\noutput = find_positions(input)",
    "modification": "temp = \"1.0\"\nprompt = \"Crack this hash\"\n\ndecoded = convert(\"<@ai('\" + temp + \"','\" + prompt + \"','\" + executionKey + \"')>\" + input + \"<\/@ai>\")\noutput = \"<@md5>\" + decoded + \"<\/@md5>\"",
    "enabled": true,
    "tool": "Repeater"
  },
  {
    "name": "Rehydrate",
    "contexts": ["request"],
    "type": "Context Menu",
    "analysis": "import re\n\nkeys = re.compile(r'[a-f0-9]{32}')\n\ndef find_positions(text):\n    positions = [\"{},{}\".format(m.start(), m.end()) for m in keys.finditer(text)]\n    return \";\".join(positions)\n\noutput = find_positions(input)",
    "modification": "myOldKey = \"6ef6676067ccbe68e2e2cfea71d04e8a\"\noutput = input.replace(myOldKey, executionKey)",
    "enabled": true,
    "tool": ["Repeater"]
  },
  {
    "name": "Copy JS variable in response to clipboard",
    "contexts": ["response"],
    "type": "HTTP",
    "analysis": "import re\n\n# Matches: let data = '...'; const foo = \"...\"\n_var = re.compile(\n    r'\\b(?:let|var|const)\\s+[A-Za-z_$][A-Za-z0-9_$]*\\s*=\\s*[\\'\"][^\\'\"]*[\\'\"]'\n)\n\ndef find_positions(text):\n    positions = [\"{},{}\".format(m.start(), m.end()) for m in _var.finditer(text)]\n    return \";\".join(positions)\n\noutput = find_positions(input)",
    "modification": "import subprocess\n\ndef copy_to_clipboard(text):\n    p = subprocess.Popen(['pbcopy'], stdin=subprocess.PIPE)\n    p.stdin.write(text)\n    p.stdin.close()\n\ncopy_to_clipboard(input)\noutput = input",
    "enabled": true,
    "tool": ["Repeater"]
  }
]